<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Introduction to R and Python - 6&nbsp; Data Processing and Visualization</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./08-prova.html" rel="next">
<link href="./05-fundamentos_python.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./05-fundamentos_python.html">Learning Python</a></li><li class="breadcrumb-item"><a href="./06-visualizacao_python.html"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Data Processing and Visualization</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Introduction to R and Python</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Learning R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-fundamentos_r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">R Fundamentals</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-fluxos.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Execution Flows</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-dados.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Data Manipulation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-visualizacao.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Data Visualization</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Learning Python</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-fundamentos_python.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Python Fundamentals</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-visualizacao_python.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Data Processing and Visualization</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Case studies</span></span>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">Final Exam</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-prova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Exam</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#library-installation" id="toc-library-installation" class="nav-link active" data-scroll-target="#library-installation"><span class="header-section-number">6.1</span> Library Installation</a></li>
  <li><a href="#numerical-data-processing" id="toc-numerical-data-processing" class="nav-link" data-scroll-target="#numerical-data-processing"><span class="header-section-number">6.2</span> Numerical Data Processing</a></li>
  <li><a href="#data-analysis-and-processing" id="toc-data-analysis-and-processing" class="nav-link" data-scroll-target="#data-analysis-and-processing"><span class="header-section-number">6.3</span> Data Analysis and Processing</a></li>
  <li><a href="#what-is-pandas" id="toc-what-is-pandas" class="nav-link" data-scroll-target="#what-is-pandas"><span class="header-section-number">6.4</span> What is Pandas?</a>
  <ul class="collapse">
  <li><a href="#series" id="toc-series" class="nav-link" data-scroll-target="#series"><span class="header-section-number">6.4.1</span> Series</a></li>
  <li><a href="#dataframe" id="toc-dataframe" class="nav-link" data-scroll-target="#dataframe"><span class="header-section-number">6.4.2</span> DataFrame</a></li>
  <li><a href="#main-functionalities" id="toc-main-functionalities" class="nav-link" data-scroll-target="#main-functionalities"><span class="header-section-number">6.4.3</span> Main Functionalities</a></li>
  </ul></li>
  <li><a href="#tidy-data" id="toc-tidy-data" class="nav-link" data-scroll-target="#tidy-data"><span class="header-section-number">6.5</span> Tidy Data</a></li>
  <li><a href="#data-visualization" id="toc-data-visualization" class="nav-link" data-scroll-target="#data-visualization"><span class="header-section-number">6.6</span> Data Visualization</a>
  <ul class="collapse">
  <li><a href="#matplotlib" id="toc-matplotlib" class="nav-link" data-scroll-target="#matplotlib"><span class="header-section-number">6.6.1</span> Matplotlib</a></li>
  <li><a href="#plotnine" id="toc-plotnine" class="nav-link" data-scroll-target="#plotnine"><span class="header-section-number">6.6.2</span> Plotnine</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Data Processing and Visualization</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="library-installation" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="library-installation"><span class="header-section-number">6.1</span> Library Installation</h2>
<p>Installing libraries in Python is essential to expand the language’s functionality. There are several ways to install libraries, but the most common is using a package manager. Pip is the default package manager for Python and usually comes with the Python installation.</p>
<p>To install a library with pip, open the terminal or command prompt and type the following command:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pip install library_name</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Replace <code>library_name</code> with the name of the library you want to install.</p>
</section>
<section id="numerical-data-processing" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="numerical-data-processing"><span class="header-section-number">6.2</span> Numerical Data Processing</h2>
<p><code>NumPy</code> (Numerical Python) is an essential library for numerical computing in Python. It provides efficient data structures for working with multidimensional arrays and powerful mathematical functions for data manipulation.</p>
<p>To install NumPy, you can use pip, the default Python package manager:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>pip install numpy</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The main object in <code>NumPy</code> is the multidimensional array. You can create <code>NumPy</code> arrays using the <code>numpy.array()</code> function and perform basic mathematical operations with them:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating a NumPy array</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>arr <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>])</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Basic mathematical operations</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Sum:"</span>, np.<span class="bu">sum</span>(arr))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Sum: 15</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Mean:"</span>, np.mean(arr))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Mean: 3.0</code></pre>
</div>
</div>
<p>In addition to basic operations, NumPy provides universal functions (<code>ufuncs</code>) to apply operations to all elements of an array at once:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Universal functions (ufuncs)</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>arr <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>])</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Square of each element:"</span>, np.square(arr))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Square of each element: [ 1  4  9 16 25]</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Exponential of each element:"</span>, np.exp(arr))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Exponential of each element: [  2.71828183   7.3890561   20.08553692  54.59815003 148.4131591 ]</code></pre>
</div>
</div>
<p>Next, we present three practical examples of using <code>NumPy</code> functions.</p>
<p><strong>Example 1: Descriptive Statistics Calculation</strong></p>
<p><code>NumPy</code> can be used to calculate descriptive statistics, such as mean, median, standard deviation, minimum, and maximum of time series data, such as the stock price of a company over time.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Stock price of a company over time (in dollars)</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>prices <span class="op">=</span> np.array([<span class="dv">100</span>, <span class="dv">102</span>, <span class="dv">105</span>, <span class="dv">110</span>, <span class="dv">108</span>, <span class="dv">115</span>, <span class="dv">120</span>])</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculating descriptive statistics</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Mean:"</span>, np.mean(prices))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Mean: 108.57142857142857</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Standard deviation:"</span>, np.std(prices))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Standard deviation: 6.58693821908486</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Maximum:"</span>, np.<span class="bu">max</span>(prices))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Maximum: 120</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Minimum:"</span>, np.<span class="bu">min</span>(prices))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Minimum: 100</code></pre>
</div>
</div>
<p><strong>Example 2: Time Series Analysis</strong> <code>NumPy</code> is useful for time series manipulation and analysis. For example, you can use <code>NumPy</code> to calculate the return rate of an investment over time or to smooth a time series using moving averages.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>prices <span class="op">=</span> np.array([<span class="dv">100</span>, <span class="dv">102</span>, <span class="dv">105</span>, <span class="dv">110</span>, <span class="dv">108</span>, <span class="dv">115</span>, <span class="dv">120</span>])</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculating the return rate of an investment over time</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>returns <span class="op">=</span> np.diff(prices) <span class="op">/</span> prices[:<span class="op">-</span><span class="dv">1</span>] <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Return rate:"</span>, returns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Return rate: [ 2.          2.94117647  4.76190476 -1.81818182  6.48148148  4.34782609]</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>The <code>np.diff</code> function in NumPy is used to calculate the difference between consecutive elements along a specified axis of an array. <em>Note</em>: The size of the output from the <code>np.diff</code> function will always be one less than the size of the original input vector. For example, if we have a one-dimensional vector with <span class="math inline">\(n\)</span> elements, the <code>np.diff</code> function will return a vector with <span class="math inline">\(n−1\)</span> elements, as there is no difference for the last element.</p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>prices <span class="op">=</span> np.array([<span class="dv">100</span>, <span class="dv">102</span>, <span class="dv">105</span>, <span class="dv">110</span>, <span class="dv">108</span>, <span class="dv">115</span>, <span class="dv">120</span>])</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Smoothing a time series using moving averages</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>window_size <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>moving_average <span class="op">=</span> np.convolve(prices, np.ones(window_size) <span class="op">/</span> window_size, mode<span class="op">=</span><span class="st">'valid'</span>)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Moving averages:"</span>, moving_average)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Moving averages: [102.33333333 105.66666667 107.66666667 111.         114.33333333]</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>The <code>np.convolve</code> function in <code>NumPy</code> is used to perform convolution between two sequences, represented by two one-dimensional vectors. Convolution is a mathematical operation that combines two functions to produce a third function that represents the amount of overlap between them as one is shifted along the axis.</p>
<p>The basic syntax of the function is <code>np.convolve(a, b, mode='full')</code>, where <code>a</code> and <code>b</code> are the two one-dimensional vectors to be convolved, and <code>mode</code> is an optional parameter that defines the convolution mode. The most common modes are:</p>
<ul>
<li><code>'full'</code>: Returns the full output of the convolution. The length of the result will be <code>len(a) + len(b) - 1</code>.</li>
<li><code>'valid'</code>: Returns only points where the sequences fully overlap. The length of the result will be <code>max(len(a), len(b)) - min(len(a), len(b)) + 1</code>.</li>
<li><code>'same'</code>: Returns output of the same size as the longest input vector. The length of the result will be <code>max(len(a), len(b))</code>.</li>
</ul>
<p>In the previous example, the <code>np.convolve</code> function was used here to calculate the moving average of prices. In this case, the first sequence is the price vector, and the second sequence is a vector of 1s divided by the moving average window size. This creates a sequence that represents a weighted average of the values.</p>
</div>
</div>
<p><strong>Example 3: Monte Carlo Simulation</strong> NumPy can be used to perform Monte Carlo simulations, which are widely used in financial modeling and risk assessment. For example, you can simulate the performance of an investment portfolio over time under different market scenarios.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Monte Carlo simulation of an investment portfolio's performance</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>num_simulations <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>num_years <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>mean_return <span class="op">=</span> <span class="fl">0.08</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>volatility <span class="op">=</span> <span class="fl">0.15</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Generating random returns using a normal distribution</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>returns <span class="op">=</span> np.random.normal(mean_return, volatility, size<span class="op">=</span>(num_simulations, num_years))</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculating the final portfolio value for each simulation</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>initial_investment <span class="op">=</span> <span class="dv">10000</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>final_values <span class="op">=</span> initial_investment <span class="op">*</span> np.cumprod(<span class="dv">1</span> <span class="op">+</span> returns, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Descriptive statistics of the final portfolio values</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Mean final value:"</span>, np.mean(final_values[:,<span class="op">-</span><span class="dv">1</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Mean final value: 21532.622967818224</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Standard deviation of final values:"</span>, np.std(final_values[:,<span class="op">-</span><span class="dv">1</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Standard deviation of final values: 9696.09187831584</code></pre>
</div>
</div>
<p>More references on <code>NumPy</code>:</p>
<ul>
<li><p><strong>Official NumPy Documentation:</strong> <a href="https://numpy.org/doc/stable/" class="uri">https://numpy.org/doc/stable/</a> The official NumPy documentation contains detailed information on all available functions and methods, as well as tutorials and examples.</p></li>
<li><p><strong>NumPy Quickstart Tutorial:</strong> <a href="https://numpy.org/doc/stable/user/quickstart.html" class="uri">https://numpy.org/doc/stable/user/quickstart.html</a> This quickstart tutorial provides a quick introduction to NumPy and its basic functionalities.</p></li>
</ul>
</section>
<section id="data-analysis-and-processing" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="data-analysis-and-processing"><span class="header-section-number">6.3</span> Data Analysis and Processing</h2>
<p>Pandas is a widely used open-source library in Python for data analysis and manipulation. It provides flexible data structures and powerful tools for working with structured data, facilitating data analysis, cleaning, and preparation for various applications, such as data science, finance, academic research, and more.</p>
</section>
<section id="what-is-pandas" class="level2" data-number="6.4">
<h2 data-number="6.4" class="anchored" data-anchor-id="what-is-pandas"><span class="header-section-number">6.4</span> What is Pandas?</h2>
<p>Pandas is an open-source Python library that offers high-performance data structures and data analysis tools. Pandas is designed to handle the complexities of real-world data analysis, offering a simple and intuitive interface for working with tabular data.</p>
<p>Pandas is widely used in data analysis due to its ability to:</p>
<ul>
<li>Import and export data from a variety of sources, including CSV, Excel, SQL, JSON, HDF5 files, and more.</li>
<li>Efficiently manipulate data, including indexing, filtering, aggregation, and cleaning.</li>
<li>Perform statistical and mathematical operations on data, such as mean, sum, standard deviation, correlation, etc.</li>
</ul>
<p>The two main data structures provided by Pandas are Series and DataFrames.</p>
<section id="series" class="level3" data-number="6.4.1">
<h3 data-number="6.4.1" class="anchored" data-anchor-id="series"><span class="header-section-number">6.4.1</span> Series</h3>
<p>A <code>Series</code> is a one-dimensional data structure that can contain any type of data, such as integers, floats, strings, among others. Each element in a Series has a unique label called an index. The Series is similar to a list or one-dimensional array in Python but provides additional features, such as vectorized operations and automatic data alignment based on index labels.</p>
<p>Suppose we have a Series representing the daily prices of a stock:</p>
<table class="table">
<thead>
<tr class="header">
<th>Date</th>
<th>Price</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2024-03-18</td>
<td>100</td>
</tr>
<tr class="even">
<td>2024-03-19</td>
<td>105</td>
</tr>
<tr class="odd">
<td>2024-03-20</td>
<td>98</td>
</tr>
<tr class="even">
<td>2024-03-21</td>
<td>102</td>
</tr>
</tbody>
</table>
<p>We can create a Pandas Series to represent this data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Stock price data</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> [<span class="st">'2024-03-18'</span>, <span class="st">'2024-03-19'</span>, <span class="st">'2024-03-20'</span>, <span class="st">'2024-03-21'</span>]</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>prices <span class="op">=</span> [<span class="dv">100</span>, <span class="dv">105</span>, <span class="dv">98</span>, <span class="dv">102</span>]</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating a Pandas Series</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>stock_price_series <span class="op">=</span> pd.Series(prices, index<span class="op">=</span>pd.to_datetime(data), name<span class="op">=</span><span class="st">'Stock Price'</span>)</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(stock_price_series)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>2024-03-18    100
2024-03-19    105
2024-03-20     98
2024-03-21    102
Name: Stock Price, dtype: int64</code></pre>
</div>
</div>
</section>
<section id="dataframe" class="level3" data-number="6.4.2">
<h3 data-number="6.4.2" class="anchored" data-anchor-id="dataframe"><span class="header-section-number">6.4.2</span> DataFrame</h3>
<p>A DataFrame is a two-dimensional data structure similar to a database table or an Excel spreadsheet. It consists of rows and columns, where each column can contain a different data type. Each column and row in a DataFrame has a unique label called an index and a name, respectively. The DataFrame allows for a wide range of data manipulation and analysis operations, such as indexing, filtering, aggregation, cleaning, among others.</p>
<p>Suppose we have a DataFrame representing the daily prices of multiple stocks. We can create a Pandas DataFrame to represent this data. See the example below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Stock price data</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> [<span class="st">'2024-03-18'</span>, <span class="st">'2024-03-19'</span>, <span class="st">'2024-03-20'</span>, <span class="st">'2024-03-21'</span>]</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>stock_prices <span class="op">=</span> {</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Stock 1'</span>: [<span class="dv">100</span>, <span class="dv">105</span>, np.nan, <span class="dv">102</span>],</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Stock 2'</span>: [<span class="dv">50</span>, <span class="dv">52</span>, <span class="dv">48</span>, <span class="dv">49</span>],</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Stock 3'</span>: [<span class="dv">75</span>, np.nan, <span class="dv">72</span>, <span class="dv">74</span>]</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating a Pandas DataFrame</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>df_stock_prices <span class="op">=</span> pd.DataFrame(stock_prices, index<span class="op">=</span>pd.to_datetime(data))</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_stock_prices)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Stock 1  Stock 2  Stock 3
2024-03-18    100.0       50     75.0
2024-03-19    105.0       52      NaN
2024-03-20      NaN       48     72.0
2024-03-21    102.0       49     74.0</code></pre>
</div>
</div>
</section>
<section id="main-functionalities" class="level3" data-number="6.4.3">
<h3 data-number="6.4.3" class="anchored" data-anchor-id="main-functionalities"><span class="header-section-number">6.4.3</span> Main Functionalities</h3>
<p>The <code>df.isna()</code> function is a function provided by Pandas in a DataFrame (df) that returns a boolean matrix indicating whether each element in the DataFrame is a missing value (NaN).</p>
<p>When applied to a DataFrame, the <code>isna()</code> function returns a DataFrame with the same shape, where each value is replaced by <code>True</code> if it is <code>NaN</code> and <code>False</code> otherwise.</p>
<p>This is useful for quickly identifying missing values in a DataFrame and performing data cleaning or handling operations, such as filling missing values or removing rows or columns containing these values.</p>
<p>If we apply <code>df_stock_prices.isna()</code>, we get:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>df_stock_prices.isna()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Stock 1  Stock 2  Stock 3
2024-03-18    False    False    False
2024-03-19    False    False     True
2024-03-20     True    False    False
2024-03-21    False    False    False</code></pre>
</div>
</div>
<p>To count the number of <code>NaN</code> values in each column, combine <code>is.na()</code> with <code>sum()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>df_stock_prices.isna().<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Stock 1    1
Stock 2    0
Stock 3    1
dtype: int64</code></pre>
</div>
</div>
<p>The <code>dropna()</code> method in Pandas is used to remove rows or columns that contain missing values (NaN).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>df_stock_prices.dropna()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Stock 1  Stock 2  Stock 3
2024-03-18    100.0       50     75.0
2024-03-21    102.0       49     74.0</code></pre>
</div>
</div>
<p>The <code>subset</code> parameter is used to specify in which columns or rows Pandas should look for missing values before removing. When we use <code>df.dropna(subset=["Stock 3"])</code>, we are instructing Pandas to remove all rows where there is a missing value in the “Stock 3” column.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>df_stock_prices.dropna(subset<span class="op">=</span>[<span class="st">"Stock 3"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Stock 1  Stock 2  Stock 3
2024-03-18    100.0       50     75.0
2024-03-20      NaN       48     72.0
2024-03-21    102.0       49     74.0</code></pre>
</div>
</div>
<p>In the <code>dropna()</code> function, the <code>inplace=True</code> parameter specifies that the modification should be made directly to the original DataFrame, rather than returning a new DataFrame without the missing values. When <code>inplace=True</code> is used with <code>dropna()</code>, the original DataFrame is modified, and the rows or columns with missing values are permanently removed.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>df_stock_prices.dropna(inplace <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <code>fillna()</code> function in Pandas is used to fill missing values (NaN) in a DataFrame with a specific value.</p>
<p>Consider the following DataFrame <code>df</code> representing customer data from a bank with some missing data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> {<span class="st">'Name'</span>: [<span class="st">"John"</span>, <span class="st">"Mary"</span>, <span class="st">"Peter"</span>, <span class="st">"Anna"</span>, <span class="st">"Marianne"</span>],</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Age'</span>: [<span class="dv">25</span>, <span class="dv">30</span>, np.nan, <span class="dv">40</span>, <span class="dv">35</span>],</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Monthly Income'</span>: [<span class="dv">5000</span>, <span class="dv">6000</span>, np.nan, <span class="dv">4500</span>, <span class="dv">5500</span>],</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Credit Limit'</span>: [<span class="dv">10000</span>, np.nan, <span class="dv">8000</span>, <span class="dv">12000</span>, np.nan]}</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>df_customers <span class="op">=</span> pd.DataFrame(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In this example,</p>
<ul>
<li>The missing values in the “Age” column will be filled with the median of the existing ages in the DataFrame.</li>
<li>The missing values in the “Credit Limit” column will be filled with the mode of the existing credit limits in the DataFrame.</li>
<li>The missing values in the “Monthly Income” column will be filled with the mean of the existing monthly incomes in the DataFrame.</li>
</ul>
<p>See the code below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filling missing values in the 'Age' column with the median of existing ages</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>df_customers[<span class="st">'Age'</span>] <span class="op">=</span> df_customers[<span class="st">'Age'</span>].fillna(df_customers[<span class="st">'Age'</span>].median())</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Filling missing values in the 'Credit Limit' column with the mode of existing credit limits</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>df_customers[<span class="st">'Credit Limit'</span>] <span class="op">=</span> df_customers[<span class="st">'Credit Limit'</span>].fillna(df_customers[<span class="st">'Credit Limit'</span>].mode()[<span class="dv">0</span>])</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Filling missing values in the 'Monthly Income' column with the mean of existing monthly incomes</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>df_customers[<span class="st">'Monthly Income'</span>] <span class="op">=</span> df_customers[<span class="st">'Monthly Income'</span>].fillna(df_customers[<span class="st">'Monthly Income'</span>].mean())</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>df_customers</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       Name   Age  Monthly Income  Credit Limit
0      John  25.0          5000.0       10000.0
1      Mary  30.0          6000.0        8000.0
2     Peter  32.5          5250.0        8000.0
3      Anna  40.0          4500.0       12000.0
4  Marianne  35.0          5500.0        8000.0</code></pre>
</div>
</div>
<p>Now, let’s load the <code>gapminder</code> data, which is in the <code>gapminder.zip</code> file.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="op">=</span> pd.read_csv(<span class="st">"data/gapminder.zip"</span>, sep <span class="op">=</span> <span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <code>head()</code> function is used to view the first few rows of the <code>gapminder</code> dataset, providing a quick overview of its structure and content.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>gapminder.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       country continent  year  lifeExp       pop   gdpPercap
0  Afghanistan      Asia  1952   28.801   8425333  779.445314
1  Afghanistan      Asia  1957   30.332   9240934  820.853030
2  Afghanistan      Asia  1962   31.997  10267083  853.100710
3  Afghanistan      Asia  1967   34.020  11537966  836.197138
4  Afghanistan      Asia  1972   36.088  13079460  739.981106</code></pre>
</div>
</div>
<p>The <code>info()</code> method provides information about the dataset, including the number of entries, the data type of each column, and whether there are any null values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>gapminder.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 1704 entries, 0 to 1703
Data columns (total 6 columns):
 #   Column     Non-Null Count  Dtype  
---  ------     --------------  -----  
 0   country    1704 non-null   object 
 1   continent  1704 non-null   object 
 2   year       1704 non-null   int64  
 3   lifeExp    1704 non-null   float64
 4   pop        1704 non-null   int64  
 5   gdpPercap  1704 non-null   float64
dtypes: float64(2), int64(2), object(2)
memory usage: 80.0+ KB</code></pre>
</div>
</div>
<p>The <code>describe()</code> function generates descriptive statistics for each numeric column in the dataset, such as count, mean, standard deviation, minimum, and maximum.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>gapminder.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             year      lifeExp           pop      gdpPercap
count  1704.00000  1704.000000  1.704000e+03    1704.000000
mean   1979.50000    59.474439  2.960121e+07    7215.327081
std      17.26533    12.917107  1.061579e+08    9857.454543
min    1952.00000    23.599000  6.001100e+04     241.165876
25%    1965.75000    48.198000  2.793664e+06    1202.060309
50%    1979.50000    60.712500  7.023596e+06    3531.846988
75%    1993.25000    70.845500  1.958522e+07    9325.462346
max    2007.00000    82.603000  1.318683e+09  113523.132900</code></pre>
</div>
</div>
<p>The <code>value_counts()</code> function counts the number of occurrences of each category in the “continent” column of the <code>gapminder</code> dataset, transforms the results into a DataFrame, renames the columns to “continent” and “n” (indicating the count), and resets the index.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>gapminder.value_counts(<span class="st">"continent"</span>).to_frame(<span class="st">"n"</span>).reset_index()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  continent    n
0    Africa  624
1      Asia  396
2    Europe  360
3  Americas  300
4   Oceania   24</code></pre>
</div>
</div>
<p>In the following snippet, we perform a value count for the unique combinations of categories in the “continent” and “year” columns of the <code>gapminder</code> DataFrame. The results are transformed into a DataFrame, renamed as “continent”, “year”, and “n” (indicating the count), and the index is reset.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>gapminder.value_counts([<span class="st">"continent"</span>, <span class="st">"year"</span>]).to_frame(<span class="st">"n"</span>).reset_index()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   continent  year   n
0     Africa  1952  52
1     Africa  1987  52
2     Africa  1957  52
3     Africa  2002  52
4     Africa  1997  52
5     Africa  1992  52
6     Africa  2007  52
7     Africa  1982  52
8     Africa  1977  52
9     Africa  1972  52
10    Africa  1967  52
11    Africa  1962  52
12      Asia  1952  33
13      Asia  2007  33
14      Asia  2002  33
15      Asia  1997  33
16      Asia  1992  33
17      Asia  1987  33
18      Asia  1977  33
19      Asia  1972  33
20      Asia  1967  33
21      Asia  1962  33
22      Asia  1957  33
23      Asia  1982  33
24    Europe  1982  30
25    Europe  1957  30
26    Europe  2007  30
27    Europe  2002  30
28    Europe  1997  30
29    Europe  1992  30
30    Europe  1987  30
31    Europe  1977  30
32    Europe  1972  30
33    Europe  1967  30
34    Europe  1962  30
35    Europe  1952  30
36  Americas  2002  25
37  Americas  2007  25
38  Americas  1952  25
39  Americas  1962  25
40  Americas  1967  25
41  Americas  1972  25
42  Americas  1977  25
43  Americas  1982  25
44  Americas  1987  25
45  Americas  1992  25
46  Americas  1997  25
47  Americas  1957  25
48   Oceania  1982   2
49   Oceania  2002   2
50   Oceania  1997   2
51   Oceania  1992   2
52   Oceania  1987   2
53   Oceania  1957   2
54   Oceania  1977   2
55   Oceania  1972   2
56   Oceania  1967   2
57   Oceania  1962   2
58   Oceania  1952   2
59   Oceania  2007   2</code></pre>
</div>
</div>
</section>
</section>
<section id="tidy-data" class="level2" data-number="6.5">
<h2 data-number="6.5" class="anchored" data-anchor-id="tidy-data"><span class="header-section-number">6.5</span> Tidy Data</h2>
<p>All the tables below contain the same data (taken from the <code>tidyr</code> package in R), which shows the number of cases of a disease and the total population of some countries.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>table1 <span class="op">=</span> pd.read_csv(<span class="st">"data/table1.csv"</span>)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>table2 <span class="op">=</span> pd.read_csv(<span class="st">"data/table2.csv"</span>)</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>table3 <span class="op">=</span> pd.read_csv(<span class="st">"data/table3.csv"</span>)</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>table4a <span class="op">=</span> pd.read_csv(<span class="st">"data/table4a.csv"</span>)</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>table4b <span class="op">=</span> pd.read_csv(<span class="st">"data/table4b.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>table1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       country  year   cases  population
0  Afghanistan  1999     745    19987071
1  Afghanistan  2000    2666    20595360
2       Brazil  1999   37737   172006362
3       Brazil  2000   80488   174504898
4        China  1999  212258  1272915272
5        China  2000  213766  1280428583</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>table2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        country  year        type       count
0   Afghanistan  1999       cases         745
1   Afghanistan  1999  population    19987071
2   Afghanistan  2000       cases        2666
3   Afghanistan  2000  population    20595360
4        Brazil  1999       cases       37737
5        Brazil  1999  population   172006362
6        Brazil  2000       cases       80488
7        Brazil  2000  population   174504898
8         China  1999       cases      212258
9         China  1999  population  1272915272
10        China  2000       cases      213766
11        China  2000  population  1280428583</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>table3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       country  year               rate
0  Afghanistan  1999       745/19987071
1  Afghanistan  2000      2666/20595360
2       Brazil  1999    37737/172006362
3       Brazil  2000    80488/174504898
4        China  1999  212258/1272915272
5        China  2000  213766/1280428583</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>table4a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       country    1999    2000
0  Afghanistan     745    2666
1       Brazil   37737   80488
2        China  212258  213766</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>table4b</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       country        1999        2000
0  Afghanistan    19987071    20595360
1       Brazil   172006362   174504898
2        China  1272915272  1280428583</code></pre>
</div>
</div>
<p>The example below creates a new column called <code>rate</code> in the <code>table1</code> DataFrame. The <code>assign</code> function adds a new column to the DataFrame, while the <code>lambda</code> expression calculates the values for this new column.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>table1.assign(rate <span class="op">=</span> <span class="kw">lambda</span> _: <span class="dv">10000</span> <span class="op">*</span> (_.cases <span class="op">/</span> _.population))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       country  year   cases  population      rate
0  Afghanistan  1999     745    19987071  0.372741
1  Afghanistan  2000    2666    20595360  1.294466
2       Brazil  1999   37737   172006362  2.193930
3       Brazil  2000   80488   174504898  4.612363
4        China  1999  212258  1272915272  1.667495
5        China  2000  213766  1280428583  1.669488</code></pre>
</div>
</div>
<p>In the example below, we group the data in the <code>table1</code> DataFrame by the “year” column and then calculate the sum of cases for each year. The <code>groupby("year")</code> method groups the data by year, creating separate groups for each year. <code>as_index = False</code> specifies that the column used for grouping (“year”) should not be set as the index in the resulting DataFrame. The <code>agg</code> method is used to perform an aggregation operation on the groups. Here, <code>np.sum</code> is used to calculate the sum of the values in the “cases” column for each group.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>(table1.groupby(<span class="st">"year"</span>, as_index <span class="op">=</span> <span class="va">False</span>)</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>       .agg(total_cases <span class="op">=</span> (<span class="st">"cases"</span>, np.<span class="bu">sum</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   year  total_cases
0  1999       250740
1  2000       296920</code></pre>
</div>
</div>
<p>To do the same with the data from <code>table1</code>, we have to use the <code>pivot_table</code> function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>table2_tidy <span class="op">=</span> (table2.pivot_table(index <span class="op">=</span> [<span class="st">"country"</span>, <span class="st">"year"</span>], columns <span class="op">=</span> <span class="st">"type"</span>, values <span class="op">=</span> <span class="st">"count"</span>)</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>               .reset_index()</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>               .rename_axis(<span class="va">None</span>, axis <span class="op">=</span> <span class="dv">1</span>))</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>table2_tidy.assign(rate <span class="op">=</span> <span class="kw">lambda</span> _: <span class="dv">10000</span> <span class="op">*</span> (_.cases <span class="op">/</span> _.population))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       country  year     cases    population      rate
0  Afghanistan  1999     745.0  1.998707e+07  0.372741
1  Afghanistan  2000    2666.0  2.059536e+07  1.294466
2       Brazil  1999   37737.0  1.720064e+08  2.193930
3       Brazil  2000   80488.0  1.745049e+08  4.612363
4        China  1999  212258.0  1.272915e+09  1.667495
5        China  2000  213766.0  1.280429e+09  1.669488</code></pre>
</div>
</div>
<p>In the example above, we use the <code>pivot_table</code> method from Pandas to reorganize the data in the <code>table2</code> DataFrame. It reorganizes the data so that the values in the “count” column are pivoted (transformed into columns) based on the unique values of the combination of “country” and “year”. The <code>index</code>, <code>columns</code>, and <code>values</code> parameters specify the columns to be used as the index, the columns to be transformed into columns, and the values to be filled in the pivot table, respectively. After the pivot operation, additional methods are chained to modify the structure of the resulting DataFrame:</p>
<ul>
<li><code>reset_index()</code> resets the DataFrame’s indices to default numeric indices, moving the previous indices (in this case, “country” and “year”) to columns.</li>
<li><code>rename_axis(None, axis=1)</code> removes the column index names, replacing them with <code>None</code>. This is done specifically to clean up the column names of the DataFrame.</li>
</ul>
<p>After transforming the data, the <code>assign</code> function is used to create a new column called <code>rate</code> in the resulting DataFrame <code>table2_tidy</code>.</p>
<p>Now, let’s do the same for <code>table4a</code> and <code>table4b</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>table4_tidy <span class="op">=</span> (table4a.melt(id_vars <span class="op">=</span> <span class="st">"country"</span>, value_vars <span class="op">=</span> [<span class="st">"1999"</span>, <span class="st">"2000"</span>], var_name <span class="op">=</span> <span class="st">"year"</span>, value_name <span class="op">=</span> <span class="st">"cases"</span>)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>                .merge(table4b.melt(id_vars <span class="op">=</span> <span class="st">"country"</span>, value_vars <span class="op">=</span> [<span class="st">"1999"</span>, <span class="st">"2000"</span>], var_name <span class="op">=</span> <span class="st">"year"</span>, value_name <span class="op">=</span> <span class="st">"population"</span>),</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>                       on <span class="op">=</span> (<span class="st">"country"</span>, <span class="st">"year"</span>)))</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>table4_tidy.assign(rate <span class="op">=</span> <span class="kw">lambda</span> _: <span class="dv">10000</span> <span class="op">*</span> (_.cases <span class="op">/</span> _.population))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       country  year   cases  population      rate
0  Afghanistan  1999     745    19987071  0.372741
1       Brazil  1999   37737   172006362  2.193930
2        China  1999  212258  1272915272  1.667495
3  Afghanistan  2000    2666    20595360  1.294466
4       Brazil  2000   80488   174504898  4.612363
5        China  2000  213766  1280428583  1.669488</code></pre>
</div>
</div>
<p>The DataFrames <code>table4a</code> and <code>table4b</code> are melted using the <code>melt</code> method:</p>
<ul>
<li><p>For <code>table4a</code>, the columns that will remain fixed are specified through the argument <code>id_vars = "country"</code>, while the columns “1999” and “2000” are melted as variables using <code>value_vars = ["1999", "2000"]</code>. The names of the melted variables are renamed to “year” and “cases” using <code>var_name = "year"</code> and <code>value_name = "cases"</code>, respectively.</p></li>
<li><p>Similarly, for <code>table4b</code>, the columns “country” and “1999”, “2000” are melted, with the variable names renamed to “year” and “population”, respectively.</p></li>
</ul>
<p>The DataFrames resulting from the melting of <code>table4a</code> and <code>table4b</code> are merged using the <code>merge</code> method. The merge is performed based on the columns “country” and “year”, ensuring that corresponding data from <code>table4a</code> and <code>table4b</code> are correctly combined.</p>
<p>Finally, the <code>assign</code> method is used to create a new column called “rate”, which represents the number of cases per 10,000 inhabitants.</p>
<p>For <code>table3</code>, just split the <code>cases</code> column using the separator <code>/</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(table3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       country  year               rate
0  Afghanistan  1999       745/19987071
1  Afghanistan  2000      2666/20595360
2       Brazil  1999    37737/172006362
3       Brazil  2000    80488/174504898
4        China  1999  212258/1272915272
5        China  2000  213766/1280428583</code></pre>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>table3_tidy <span class="op">=</span> (table3.assign(cases <span class="op">=</span> <span class="kw">lambda</span> _: _.rate.<span class="bu">str</span>.split(<span class="st">"/"</span>, expand <span class="op">=</span> <span class="va">True</span>)[<span class="dv">0</span>].astype(<span class="bu">int</span>),</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>                       population <span class="op">=</span> <span class="kw">lambda</span> _: _.rate.<span class="bu">str</span>.split(<span class="st">"/"</span>,  expand <span class="op">=</span> <span class="va">True</span>)[<span class="dv">1</span>].astype(<span class="bu">int</span>))</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>               .drop(<span class="st">"rate"</span>, axis <span class="op">=</span> <span class="dv">1</span>))</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>table3_tidy</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       country  year   cases  population
0  Afghanistan  1999     745    19987071
1  Afghanistan  2000    2666    20595360
2       Brazil  1999   37737   172006362
3       Brazil  2000   80488   174504898
4        China  1999  212258  1272915272
5        China  2000  213766  1280428583</code></pre>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>table3_tidy.assign(rate <span class="op">=</span> <span class="kw">lambda</span> _: <span class="dv">10000</span> <span class="op">*</span> (_.cases <span class="op">/</span> _.population))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       country  year   cases  population      rate
0  Afghanistan  1999     745    19987071  0.372741
1  Afghanistan  2000    2666    20595360  1.294466
2       Brazil  1999   37737   172006362  2.193930
3       Brazil  2000   80488   174504898  4.612363
4        China  1999  212258  1272915272  1.667495
5        China  2000  213766  1280428583  1.669488</code></pre>
</div>
</div>
<p>The <code>expand</code> parameter is used in the <code>str.split()</code> method to specify whether the split result should be expanded into a DataFrame (if <code>True</code>) or kept as a list of values (if <code>False</code>, which is the default).</p>
<p>Main functionalities - see Paulo’s lectures</p>
<!-- lectures 4, 5 (data wrangling) and 6 (missing data) -->
</section>
<section id="data-visualization" class="level2" data-number="6.6">
<h2 data-number="6.6" class="anchored" data-anchor-id="data-visualization"><span class="header-section-number">6.6</span> Data Visualization</h2>
<p>Two widely used libraries for visualization in Python are <code>Matplotlib</code> and <code>Plotnine</code>. <code>Matplotlib</code> offers a wide range of options to create static visualizations, from simple charts to complex and customized graphs. On the other hand, <code>Plotnine</code> is a library based on the grammar of graphics (similar to R’s <code>ggplot2</code>), which makes it easy to create elegant and concise visualizations using an intuitive and expressive syntax.</p>
<section id="matplotlib" class="level3" data-number="6.6.1">
<h3 data-number="6.6.1" class="anchored" data-anchor-id="matplotlib"><span class="header-section-number">6.6.1</span> Matplotlib</h3>
<p>Before we start creating visualizations, it’s important to understand some basic concepts of Matplotlib:</p>
<ul>
<li><p><strong>Figure and Axes</strong>: In Matplotlib, a figure is the window or page where everything is drawn. Within a figure, there can be multiple axes (or subplots), where data is effectively plotted.</p></li>
<li><p><strong>The plot() Method</strong>: The <code>plot()</code> method is used to create line, point, or marker charts. It accepts various arguments to customize the appearance of the graph, such as color, line style, line width, etc.</p></li>
<li><p><strong>Customization</strong>: Matplotlib offers many customization options to adjust the appearance of charts, including adding axis labels, chart titles, legends, and more.</p></li>
</ul>
<p>Now let’s see an example of how to create a scatter plot using fictitious data, where each data unit is related to a company.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Example data: Company names, revenue, and number of employees</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>companies <span class="op">=</span> [<span class="st">'A'</span>, <span class="st">'B'</span>, <span class="st">'C'</span>, <span class="st">'D'</span>, <span class="st">'E'</span>]</span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>revenue <span class="op">=</span> [<span class="dv">200</span>, <span class="dv">300</span>, <span class="dv">400</span>, <span class="dv">250</span>, <span class="dv">350</span>]  <span class="co"># in millions of reais</span></span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>employees <span class="op">=</span> [<span class="dv">1000</span>, <span class="dv">1200</span>, <span class="dv">1500</span>, <span class="dv">900</span>, <span class="dv">1100</span>]</span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating the scatter plot</span></span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>))</span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a>plt.scatter(revenue, employees, color<span class="op">=</span><span class="st">'blue'</span>, marker<span class="op">=</span><span class="st">'o'</span>)</span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Adding labels and title</span></span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Revenue (in millions of reais)'</span>)</span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Number of Employees'</span>)</span>
<span id="cb79-15"><a href="#cb79-15" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Revenue vs. Number of Employees'</span>)</span>
<span id="cb79-16"><a href="#cb79-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-17"><a href="#cb79-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Adding annotations for each point</span></span>
<span id="cb79-18"><a href="#cb79-18" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(companies)):</span>
<span id="cb79-19"><a href="#cb79-19" aria-hidden="true" tabindex="-1"></a>    plt.annotate(companies[i], (revenue[i], employees[i]))</span>
<span id="cb79-20"><a href="#cb79-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-21"><a href="#cb79-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Displaying the plot</span></span>
<span id="cb79-22"><a href="#cb79-22" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb79-23"><a href="#cb79-23" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="06-visualizacao_python_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid" width="768"></p>
</div>
</div>
<p>In this example, each point on the graph represents a company, where the x-axis represents revenue (in millions of reais) and the y-axis represents the number of employees. Annotations are used to identify each company on the graph.</p>
<p>Next, we use Matplotlib to create a line graph representing the sales evolution of two products over several years. Each point on the graph represents the number of sales in a specific year.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Example data: Years and product sales</span></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>years <span class="op">=</span> [<span class="dv">2010</span>, <span class="dv">2011</span>, <span class="dv">2012</span>, <span class="dv">2013</span>, <span class="dv">2014</span>, <span class="dv">2015</span>, <span class="dv">2016</span>]</span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>product_A_sales <span class="op">=</span> [<span class="dv">500</span>, <span class="dv">600</span>, <span class="dv">550</span>, <span class="dv">700</span>, <span class="dv">800</span>, <span class="dv">750</span>, <span class="dv">900</span>]</span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>product_B_sales <span class="op">=</span> [<span class="dv">400</span>, <span class="dv">450</span>, <span class="dv">500</span>, <span class="dv">550</span>, <span class="dv">600</span>, <span class="dv">650</span>, <span class="dv">700</span>]</span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating the line plot</span></span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a>plt.plot(years, product_A_sales, marker<span class="op">=</span><span class="st">'o'</span>, label<span class="op">=</span><span class="st">'Product A'</span>)</span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a>plt.plot(years, product_B_sales, marker<span class="op">=</span><span class="st">'s'</span>, label<span class="op">=</span><span class="st">'Product B'</span>)</span>
<span id="cb80-12"><a href="#cb80-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-13"><a href="#cb80-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Adding labels and title</span></span>
<span id="cb80-14"><a href="#cb80-14" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Year'</span>)</span>
<span id="cb80-15"><a href="#cb80-15" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Sales'</span>)</span>
<span id="cb80-16"><a href="#cb80-16" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Sales over Time'</span>)</span>
<span id="cb80-17"><a href="#cb80-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-18"><a href="#cb80-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Adding legend</span></span>
<span id="cb80-19"><a href="#cb80-19" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb80-20"><a href="#cb80-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-21"><a href="#cb80-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Displaying the plot</span></span>
<span id="cb80-22"><a href="#cb80-22" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb80-23"><a href="#cb80-23" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="06-visualizacao_python_files/figure-html/unnamed-chunk-37-3.png" class="img-fluid" width="960"></p>
</div>
</div>
</section>
<section id="plotnine" class="level3" data-number="6.6.2">
<h3 data-number="6.6.2" class="anchored" data-anchor-id="plotnine"><span class="header-section-number">6.6.2</span> Plotnine</h3>
<p>Plotnine is a Python library that allows the creation of statistical data visualizations in a simple and concise way, using the grammar of graphics from R (also known as <code>ggplot2</code>). This grammar consists of a declarative approach to chart construction, where visual elements are added in layers to form the final graph.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> plotnine <span class="im">import</span> <span class="op">*</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To illustrate, let’s use the <code>gapminder</code> dataset.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>((ggplot(gapminder, aes(x <span class="op">=</span> <span class="st">"continent"</span>, fill <span class="op">=</span> <span class="st">"continent"</span>)) <span class="op">+</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>     geom_bar(aes(y <span class="op">=</span> <span class="st">"stat(count) / 12"</span>), alpha <span class="op">=</span> <span class="fl">0.75</span>) <span class="op">+</span></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>     labs(x <span class="op">=</span> <span class="st">""</span>, y <span class="op">=</span> <span class="st">"Number of countries"</span>, title <span class="op">=</span> <span class="st">"Continents"</span>) <span class="op">+</span></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>     theme(legend_position <span class="op">=</span> <span class="st">"none"</span>) <span class="op">+</span></span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>     coord_flip()<span class="op">+</span></span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>     theme_bw())</span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>     .show())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="06-visualizacao_python_files/figure-html/unnamed-chunk-39-5.png" class="img-fluid" width="614"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>((ggplot(gapminder, aes(x <span class="op">=</span> <span class="st">"lifeExp"</span>, y <span class="op">=</span> <span class="st">"stat(density)"</span>)) <span class="op">+</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>     geom_histogram(fill <span class="op">=</span> <span class="st">"blue"</span>, color <span class="op">=</span> <span class="st">"white"</span>, alpha <span class="op">=</span> <span class="fl">0.5</span>) <span class="op">+</span></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>     labs(x <span class="op">=</span> <span class="st">"Life Expectancy"</span>, y <span class="op">=</span> <span class="st">""</span>, title <span class="op">=</span> <span class="st">"Gapminder"</span>))</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>     .show())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="06-visualizacao_python_files/figure-html/unnamed-chunk-40-7.png" class="img-fluid" width="614"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>((ggplot(gapminder, aes(x <span class="op">=</span> <span class="st">"lifeExp"</span>, y <span class="op">=</span> <span class="st">"stat(density)"</span>)) <span class="op">+</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>     geom_histogram(fill <span class="op">=</span> <span class="st">"blue"</span>, color <span class="op">=</span> <span class="st">"white"</span>, alpha <span class="op">=</span> <span class="fl">0.5</span>) <span class="op">+</span></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>     labs(x <span class="op">=</span> <span class="st">"Life Expectancy"</span>, y <span class="op">=</span> <span class="st">""</span>, title <span class="op">=</span> <span class="st">"Gapminder"</span>) <span class="op">+</span></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>     facet_wrap(<span class="st">"~ continent"</span>, nrow <span class="op">=</span> <span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>     theme(figure_size <span class="op">=</span> (<span class="dv">12</span>, <span class="dv">2</span>))).</span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>     show)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;bound method ggplot.show of &lt;plotnine.ggplot.ggplot object at 0x00000146B542DC40&gt;&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>((gapminder.groupby([<span class="st">"continent"</span>, <span class="st">"year"</span>], as_index <span class="op">=</span> <span class="va">False</span>)</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>      .agg(median_lifeExp <span class="op">=</span> (<span class="st">"lifeExp"</span>, np.median))</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>      .pipe(<span class="kw">lambda</span> _: ggplot(_, aes(x <span class="op">=</span> <span class="st">"year"</span>, y <span class="op">=</span> <span class="st">"median_lifeExp"</span>, color <span class="op">=</span> <span class="st">"continent"</span>)) <span class="op">+</span></span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>                          geom_line(size <span class="op">=</span> <span class="fl">0.75</span>) <span class="op">+</span></span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>                          geom_point(size <span class="op">=</span> <span class="fl">1.5</span>) <span class="op">+</span></span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>                          labs(x <span class="op">=</span> <span class="st">"Year"</span>, y <span class="op">=</span> <span class="st">"Median Life Expectancy"</span>, color <span class="op">=</span> <span class="st">"Continent"</span>, title <span class="op">=</span> <span class="st">"Gapminder"</span>)))</span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a>                          .show())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="06-visualizacao_python_files/figure-html/unnamed-chunk-42-9.png" class="img-fluid" width="614"></p>
</div>
</div>
<!-- ## Advanced Data Analysis -->
<!-- ### Case 1: Visualizing `NumPy` Data with `Matplotlib` {.unnumbered} -->
<!-- The objective of this example is to demonstrate how to use NumPy and Matplotlib together to analyze simulated economic data. Read the code below and try to understand what is being done. -->
<!-- In the example above, we start by generating random data to simulate GDP values using the normal distribution with a mean of 500 and a standard deviation of 100. Next, we calculate the mean, median, and standard deviation of these values using NumPy functions. To facilitate visualization and data analysis, we plot a histogram using Matplotlib. This histogram allows us to visualize the distribution of GDP values and identify trends or patterns in the data. -->
<!-- ### Case 2: Gapminder {.unnumbered} -->
<!-- The objective of this example is to demonstrate how to use Pandas, NumPy, and Matplotlib together to perform exploratory data analysis on the Gapminder dataset. -->
<!-- In the code above, we start by loading the Gapminder data using the `pd.read_csv()` function from Pandas. Next, we calculate the mean life expectancy and the median GDP per capita using NumPy functions `np.mean()` and `np.median()`, respectively. To visualize the distribution of life expectancy, we plot a histogram using the `plt.hist()` function from Matplotlib. -->
<!-- ## Exercises -->


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./05-fundamentos_python.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Python Fundamentals</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./08-prova.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Exam</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>